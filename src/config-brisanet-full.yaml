name: "brisanet-full"
description: "Importação completa de assinaturas Brisanet"

source:
  type: "CSV"
  settings:
    FilePath: "/Users/felipeseho/Desktop/bases/full-parceiro-brisanet.csv"
    Delimiter: ";"
    StartLine: 1
    MaxLines: 1000

destination:
  type: "API"
  settings:
    EndpointUrl: "https://test-seho.requestcatcher.com/"
    Method: "POST"
    Timeout: 30
    RetryAttempts: 3
    RetryDelaySeconds: 5
    MaxRequestsPerSecond: 100
    FieldMapping:
      event: "=subscription_create"
      eventDate: "start_date"
      partner: "=brisanet"
      path: "=/api/v1/events/ingest"
      payload.campaign: "campaign"
      payload.cpf: "cpf"
      payload.email: "email"
      payload.msisdn: "msisdn"
      payload.subscriptionId: "subscription_id"

processing:
  LogDirectory: "logs"
  CheckpointDirectory: "checkpoints"
  CheckpointIntervalSeconds: 30

filters:
  - Field: "campaign"
    Operator: "NotEquals"
    Value: "Produto Revan - sem código campanha"
  - Field: "end_date"
    Operator: "Contains"
    Value: "9999"

transforms:
  - Field: "email"
    Type: "ToLower"
  - Field: "campaign"
    Type: "ToLower"
